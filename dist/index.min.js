(function(){var e=/(<\/?[\w-]+?(?:\s[^>]*)?>)/,f=/^<(\/?[\w-]+)(\s[^>]*)?>$/,g="br img hr meta input embed area base col keygen link param source".split(" ");function h(){this.a=[[]]}h.prototype.b=function(a){this.a[this.a.length-1].push(a)};function k(a,c){var b=a.a[a.a.length-1];b[b.length-1]+=c}function l(a,c,b){b&&(b=b.replace(/ ([\w-]+?)="(.+?)"/g,',"$1":"$2"').substr(1));a.b('h("'+c+'"'+(b?",{"+b+"}":""));g.some(function(b){return c===b})?k(a,")"):a.a.push([])}
function m(a){var c=new h;a.replace(/\x3c!--.*?--\x3e/,"").split(e).forEach(function(b){if(b){var a=b.match(f);a?a[1].search("/")?l(c,a[1],a[2]):(a=c.a[c.a.length-1],b=a.length,a=a.toString(),c.a.pop(),k(c,(b?",["+a+"]":"")+")")):c.b(JSON.stringify(b))}});return c.a[0].toString()}var n={"?":function(a,c){if(a)return c()},"^":function(a,c){if(!a)return c()},"#":function(a,c){return a.map(function(a){return c(a)})},"+":function(a,c){for(var b=[],d=0;d<a;d++)b.push(c(d));return b}};
module.exports=function(a,c){var b=m(a);return(new Function("r","h","o","return "+b.replace(/{{([\#\?\^\+\/]?)(.+?)}}/g,"{{$1o.$2}}").replace(/"{{([\#\?\^\+])(.+?)}}",/g,'r["$1"]($2,function(v){return ').replace(/,"{{\/.+?}}"/g,"})").replace(/{{o\.\.}}/g,"{{v}}").replace(/{{o\.\.(.+?)}}/g,"{{v.$1}}").replace(/("{{|}}")/g,"").replace(/{{/g,'"+').replace(/}}/g,'+"'))).bind(null,n,c)};}());